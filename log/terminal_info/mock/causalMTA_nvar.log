nohup: 忽略输入
'CONFIGS:\n'
{'Budget_proportion': 0.5,
 'bce_loss_nita': 0.5,
 'ce_loss_gamma': 0.5,
 'dc_batch_size': 500,
 'dc_epoch_num': 100,
 'dc_hidden_layer': 4,
 'dc_hidden_size': 10,
 'dc_learning_rate': 0.01,
 'dc_user_embedding_dim': 5,
 'device': 'cuda:0',
 'gradient_reversal_layer': True,
 'model_name': 'causalMTA',
 'model_save_path': './save/model_dict/causalMTA_nw.pth',
 'multi_gpu': False,
 'pre_dc_path': './save/model_dict/reweighting/dc/dc_1.mdl',
 'pre_vae_path': './save/model_dict/reweighting/vae/vae_01.mdl',
 'pre_weights_path': './save/model_dict/reweighting/weights/weights_03.npy',
 'predictor_batch_size': 200,
 'predictor_drop_rate': 0.2,
 'predictor_epoch_num': 100,
 'predictor_fc_hidden_dim': 48,
 'predictor_fc_hidden_layer': 2,
 'predictor_hidden_dim': 64,
 'predictor_hidden_layer_depth': 2,
 'predictor_learning_rate': 0.0001,
 'pretrained': False,
 'pretrained_conversion_pred_model': False,
 'pretrained_model_path': './save/model_dict/causalMTA_nw.pth',
 'save_model': True,
 'stored_dc_path': './save/model_dict/reweighting/dc/dc_1.mdl',
 'stored_vae_path': './save/model_dict/reweighting/vae/vae_01.mdl',
 'stored_weights_path': './save/model_dict/reweighting/weights/weights_03.npy',
 'train_dc': False,
 'train_vae': False,
 'vae_LSTM_hidden_dim': 30,
 'vae_batch_size': 200,
 'vae_epoch_num': 80,
 'vae_latent_variable_size': 5,
 'vae_learning_rate': 0.0005,
 'var_loss_lambda': 0}
{'C_embedding_dim': 4,
 'U_embedding_dim': 5,
 'cat_embedding_dim_list': [5, 5, 5, 5, 5, 5, 5, 5, 5],
 'dataset': 'Mock',
 'device': 'cuda:0',
 'file_CPO_test': './data/mock/test/CPO_test.pkl',
 'file_CPO_train': './data/mock/train/CPO_train.pkl',
 'file_C_test': './data/mock/test/C_test.pkl',
 'file_C_train': './data/mock/train/C_train.pkl',
 'file_T_test': './data/mock/test/T_test.pkl',
 'file_T_train': './data/mock/train/T_train.pkl',
 'file_U_test': './data/mock/test/U_test_new.pkl',
 'file_U_train': './data/mock/train/U_train_new.pkl',
 'file_Y_test': './data/mock/test/Y_test.pkl',
 'file_Y_train': './data/mock/train/Y_train.pkl',
 'file_cat1_9_test': './data/mock/test/cat1_9_test_new.pkl',
 'file_cat1_9_train': './data/mock/train/cat1_9_train_new.pkl',
 'file_cost_test': './data/mock/test/cost_test.pkl',
 'file_cost_train': './data/mock/train/cost_train.pkl',
 'global_campaign_size': 10,
 'global_cat_num_list': [9, 23, 63, 17, 6, 30, 806, 11, 30],
 'global_user_num': 157332,
 'pre_weights_path': './save/model_dict/reweighting/weights/weights_03.npy',
 'stored_weights_path': './save/model_dict/reweighting/weights/weights_03.npy',
 'with_weight': True}
Start Training...
Epoch: 0 | Accuracy: 0.902 | Recall: 0.195 | Precision: 0.679| RMSE: 0.3133| AUC: 0.5916 | logloss_mean: 0.336485411275576
Epoch: 1 | Accuracy: 0.903 | Recall: 0.201 | Precision: 0.699| RMSE: 0.3112| AUC: 0.5952 | logloss_mean: 0.2605854080248516
Epoch: 2 | Accuracy: 0.903 | Recall: 0.375 | Precision: 0.591| RMSE: 0.3111| AUC: 0.6716 | logloss_mean: 0.25188910604897635
Epoch: 3 | Accuracy: 0.9 | Recall: 0.366 | Precision: 0.565| RMSE: 0.3165| AUC: 0.6658 | logloss_mean: 0.2425497308717046
Epoch: 4 | Accuracy: 0.908 | Recall: 0.401 | Precision: 0.622| RMSE: 0.3036| AUC: 0.6857 | logloss_mean: 0.23286506652072506
Epoch: 5 | Accuracy: 0.907 | Recall: 0.378 | Precision: 0.622| RMSE: 0.3053| AUC: 0.6747 | logloss_mean: 0.21752417785594763
Epoch: 6 | Accuracy: 0.915 | Recall: 0.394 | Precision: 0.698| RMSE: 0.2914| AUC: 0.6865 | logloss_mean: 0.20666653692758488
Epoch: 7 | Accuracy: 0.914 | Recall: 0.401 | Precision: 0.68| RMSE: 0.2934| AUC: 0.6891 | logloss_mean: 0.1982482296496051
Epoch: 8 | Accuracy: 0.912 | Recall: 0.414 | Precision: 0.654| RMSE: 0.2968| AUC: 0.6934 | logloss_mean: 0.19195925906409048
Epoch: 9 | Accuracy: 0.908 | Recall: 0.42 | Precision: 0.617| RMSE: 0.3032| AUC: 0.6939 | logloss_mean: 0.18646513441921148
Epoch: 10 | Accuracy: 0.917 | Recall: 0.405 | Precision: 0.71| RMSE: 0.2883| AUC: 0.6924 | logloss_mean: 0.18171122398010445
Epoch: 11 | Accuracy: 0.917 | Recall: 0.425 | Precision: 0.693| RMSE: 0.2889| AUC: 0.7009 | logloss_mean: 0.17656442935316308
Epoch: 12 | Accuracy: 0.916 | Recall: 0.451 | Precision: 0.672| RMSE: 0.2901| AUC: 0.712 | logloss_mean: 0.17396332923033572
Epoch: 13 | Accuracy: 0.921 | Recall: 0.428 | Precision: 0.742| RMSE: 0.2808| AUC: 0.7049 | logloss_mean: 0.1700274428009119
Epoch: 14 | Accuracy: 0.918 | Recall: 0.435 | Precision: 0.707| RMSE: 0.2855| AUC: 0.7063 | logloss_mean: 0.1682205701391529
Epoch: 15 | Accuracy: 0.919 | Recall: 0.421 | Precision: 0.721| RMSE: 0.2848| AUC: 0.7007 | logloss_mean: 0.16666162395578565
Epoch: 16 | Accuracy: 0.921 | Recall: 0.438 | Precision: 0.733| RMSE: 0.2809| AUC: 0.7094 | logloss_mean: 0.16397485162303285
Epoch: 17 | Accuracy: 0.92 | Recall: 0.413 | Precision: 0.74| RMSE: 0.2829| AUC: 0.6976 | logloss_mean: 0.16246745246236474
Epoch: 18 | Accuracy: 0.923 | Recall: 0.467 | Precision: 0.732| RMSE: 0.2774| AUC: 0.7232 | logloss_mean: 0.1601419439358474
Epoch: 19 | Accuracy: 0.922 | Recall: 0.517 | Precision: 0.689| RMSE: 0.2799| AUC: 0.7441 | logloss_mean: 0.1584199766438563
Epoch: 20 | Accuracy: 0.923 | Recall: 0.422 | Precision: 0.765| RMSE: 0.2781| AUC: 0.703 | logloss_mean: 0.15712581761181355
Epoch: 21 | Accuracy: 0.925 | Recall: 0.457 | Precision: 0.762| RMSE: 0.2738| AUC: 0.7199 | logloss_mean: 0.15574188428722974
Epoch: 22 | Accuracy: 0.923 | Recall: 0.453 | Precision: 0.739| RMSE: 0.2781| AUC: 0.7165 | logloss_mean: 0.1545419083202927
Epoch: 23 | Accuracy: 0.926 | Recall: 0.446 | Precision: 0.79| RMSE: 0.2712| AUC: 0.7159 | logloss_mean: 0.15328440599107337
Epoch: 24 | Accuracy: 0.925 | Recall: 0.479 | Precision: 0.748| RMSE: 0.2731| AUC: 0.7298 | logloss_mean: 0.1527033530953295
Epoch: 25 | Accuracy: 0.928 | Recall: 0.459 | Precision: 0.792| RMSE: 0.269| AUC: 0.7221 | logloss_mean: 0.15148533360797514
Epoch: 26 | Accuracy: 0.926 | Recall: 0.475 | Precision: 0.758| RMSE: 0.272| AUC: 0.7281 | logloss_mean: 0.1508442397111828
Epoch: 27 | Accuracy: 0.926 | Recall: 0.501 | Precision: 0.737| RMSE: 0.2724| AUC: 0.7393 | logloss_mean: 0.15011531722650512
Epoch: 28 | Accuracy: 0.927 | Recall: 0.433 | Precision: 0.808| RMSE: 0.2706| AUC: 0.7103 | logloss_mean: 0.14836519301046155
Epoch: 29 | Accuracy: 0.927 | Recall: 0.526 | Precision: 0.731| RMSE: 0.2703| AUC: 0.7511 | logloss_mean: 0.14786662002663734
Epoch: 30 | Accuracy: 0.927 | Recall: 0.488 | Precision: 0.753| RMSE: 0.271| AUC: 0.7343 | logloss_mean: 0.1466440308242313
Epoch: 31 | Accuracy: 0.928 | Recall: 0.426 | Precision: 0.835| RMSE: 0.2683| AUC: 0.7077 | logloss_mean: 0.1462361924214632
Epoch: 32 | Accuracy: 0.928 | Recall: 0.499 | Precision: 0.762| RMSE: 0.268| AUC: 0.7397 | logloss_mean: 0.144253223917438
Epoch: 33 | Accuracy: 0.926 | Recall: 0.473 | Precision: 0.761| RMSE: 0.2718| AUC: 0.7274 | logloss_mean: 0.1445968605180099
Epoch: 34 | Accuracy: 0.93 | Recall: 0.525 | Precision: 0.761| RMSE: 0.2645| AUC: 0.7523 | logloss_mean: 0.14396599805868657
Epoch: 35 | Accuracy: 0.931 | Recall: 0.51 | Precision: 0.782| RMSE: 0.263| AUC: 0.7461 | logloss_mean: 0.1422454240704769
Epoch: 36 | Accuracy: 0.931 | Recall: 0.504 | Precision: 0.791| RMSE: 0.2623| AUC: 0.7438 | logloss_mean: 0.14177222398462372
Epoch: 37 | Accuracy: 0.929 | Recall: 0.478 | Precision: 0.79| RMSE: 0.2665| AUC: 0.731 | logloss_mean: 0.14139856295931397
Epoch: 38 | Accuracy: 0.93 | Recall: 0.503 | Precision: 0.777| RMSE: 0.2649| AUC: 0.7424 | logloss_mean: 0.14010534315252476
Epoch: 39 | Accuracy: 0.929 | Recall: 0.463 | Precision: 0.805| RMSE: 0.2665| AUC: 0.7245 | logloss_mean: 0.13953300207871402
Epoch: 40 | Accuracy: 0.931 | Recall: 0.493 | Precision: 0.796| RMSE: 0.2632| AUC: 0.7387 | logloss_mean: 0.1389402878172334
Epoch: 41 | Accuracy: 0.93 | Recall: 0.507 | Precision: 0.776| RMSE: 0.2643| AUC: 0.7448 | logloss_mean: 0.1383980165091027
Epoch: 42 | Accuracy: 0.931 | Recall: 0.481 | Precision: 0.813| RMSE: 0.2625| AUC: 0.7335 | logloss_mean: 0.1381633425203776
Epoch: 43 | Accuracy: 0.93 | Recall: 0.495 | Precision: 0.788| RMSE: 0.2641| AUC: 0.7395 | logloss_mean: 0.13661086563816638
Epoch: 44 | Accuracy: 0.931 | Recall: 0.478 | Precision: 0.809| RMSE: 0.2635| AUC: 0.7322 | logloss_mean: 0.1363227298365707
Epoch: 45 | Accuracy: 0.928 | Recall: 0.435 | Precision: 0.825| RMSE: 0.2682| AUC: 0.7118 | logloss_mean: 0.1356715294803737
Epoch: 46 | Accuracy: 0.933 | Recall: 0.495 | Precision: 0.816| RMSE: 0.2597| AUC: 0.7404 | logloss_mean: 0.1345802226501689
Epoch: 47 | Accuracy: 0.932 | Recall: 0.515 | Precision: 0.791| RMSE: 0.2606| AUC: 0.7491 | logloss_mean: 0.13435905832724954
Epoch: 48 | Accuracy: 0.931 | Recall: 0.529 | Precision: 0.763| RMSE: 0.2636| AUC: 0.7543 | logloss_mean: 0.13410898631673704
Epoch: 49 | Accuracy: 0.932 | Recall: 0.558 | Precision: 0.754| RMSE: 0.2612| AUC: 0.7678 | logloss_mean: 0.1329794024632683
Epoch: 50 | Accuracy: 0.931 | Recall: 0.47 | Precision: 0.821| RMSE: 0.2629| AUC: 0.7288 | logloss_mean: 0.13166217563348342
Epoch: 51 | Accuracy: 0.933 | Recall: 0.512 | Precision: 0.807| RMSE: 0.2584| AUC: 0.7485 | logloss_mean: 0.13184795389856094
Epoch: 52 | Accuracy: 0.931 | Recall: 0.468 | Precision: 0.829| RMSE: 0.2623| AUC: 0.7279 | logloss_mean: 0.1313233912642141
Epoch: 53 | Accuracy: 0.929 | Recall: 0.498 | Precision: 0.767| RMSE: 0.2673| AUC: 0.7397 | logloss_mean: 0.13084369207488247
Epoch: 54 | Accuracy: 0.933 | Recall: 0.534 | Precision: 0.787| RMSE: 0.2584| AUC: 0.7583 | logloss_mean: 0.13075294611451116
Epoch: 55 | Accuracy: 0.933 | Recall: 0.529 | Precision: 0.792| RMSE: 0.2584| AUC: 0.7558 | logloss_mean: 0.1291739627293953
Epoch: 56 | Accuracy: 0.932 | Recall: 0.484 | Precision: 0.826| RMSE: 0.26| AUC: 0.7358 | logloss_mean: 0.12950461464075064
Epoch: 57 | Accuracy: 0.933 | Recall: 0.516 | Precision: 0.801| RMSE: 0.2587| AUC: 0.7502 | logloss_mean: 0.12898487481514662
Epoch: 58 | Accuracy: 0.932 | Recall: 0.522 | Precision: 0.788| RMSE: 0.2601| AUC: 0.7524 | logloss_mean: 0.12854026743545405
Epoch: 59 | Accuracy: 0.932 | Recall: 0.512 | Precision: 0.789| RMSE: 0.2614| AUC: 0.7476 | logloss_mean: 0.12808773142638283
Epoch: 60 | Accuracy: 0.933 | Recall: 0.49 | Precision: 0.827| RMSE: 0.2588| AUC: 0.7387 | logloss_mean: 0.12733155430195112
Epoch: 61 | Accuracy: 0.932 | Recall: 0.503 | Precision: 0.801| RMSE: 0.2608| AUC: 0.7438 | logloss_mean: 0.12673284678530056
Epoch: 62 | Accuracy: 0.931 | Recall: 0.468 | Precision: 0.821| RMSE: 0.2633| AUC: 0.7278 | logloss_mean: 0.12627075773039922
Epoch: 63 | Accuracy: 0.934 | Recall: 0.542 | Precision: 0.793| RMSE: 0.2562| AUC: 0.7622 | logloss_mean: 0.12627547298946862
Epoch: 64 | Accuracy: 0.935 | Recall: 0.518 | Precision: 0.826| RMSE: 0.2543| AUC: 0.7523 | logloss_mean: 0.12649480940647495
Epoch: 65 | Accuracy: 0.931 | Recall: 0.511 | Precision: 0.78| RMSE: 0.2633| AUC: 0.7464 | logloss_mean: 0.12531107349447834
Epoch: 66 | Accuracy: 0.932 | Recall: 0.485 | Precision: 0.823| RMSE: 0.2603| AUC: 0.7361 | logloss_mean: 0.12514565915809672
Epoch: 67 | Accuracy: 0.932 | Recall: 0.499 | Precision: 0.811| RMSE: 0.2599| AUC: 0.7423 | logloss_mean: 0.12510919709264942
Epoch: 68 | Accuracy: 0.933 | Recall: 0.538 | Precision: 0.783| RMSE: 0.2585| AUC: 0.7598 | logloss_mean: 0.12349284125392515
Epoch: 69 | Accuracy: 0.933 | Recall: 0.57 | Precision: 0.754| RMSE: 0.2596| AUC: 0.7736 | logloss_mean: 0.12384418226796591
Epoch: 70 | Accuracy: 0.932 | Recall: 0.485 | Precision: 0.822| RMSE: 0.2604| AUC: 0.7361 | logloss_mean: 0.12325769132545707
Epoch: 71 | Accuracy: 0.933 | Recall: 0.536 | Precision: 0.784| RMSE: 0.2585| AUC: 0.759 | logloss_mean: 0.12307349919766478
Epoch: 72 | Accuracy: 0.931 | Recall: 0.51 | Precision: 0.78| RMSE: 0.2633| AUC: 0.7461 | logloss_mean: 0.12236887064662952
Epoch: 73 | Accuracy: 0.934 | Recall: 0.571 | Precision: 0.767| RMSE: 0.2567| AUC: 0.7749 | logloss_mean: 0.12157771399570177
Epoch: 74 | Accuracy: 0.934 | Recall: 0.495 | Precision: 0.833| RMSE: 0.257| AUC: 0.7415 | logloss_mean: 0.12192937395155647
Epoch: 75 | Accuracy: 0.932 | Recall: 0.488 | Precision: 0.812| RMSE: 0.2614| AUC: 0.7371 | logloss_mean: 0.12147491992207117
Epoch: 76 | Accuracy: 0.933 | Recall: 0.52 | Precision: 0.791| RMSE: 0.2597| AUC: 0.7517 | logloss_mean: 0.12105789937494883
Epoch: 77 | Accuracy: 0.933 | Recall: 0.493 | Precision: 0.817| RMSE: 0.2598| AUC: 0.7397 | logloss_mean: 0.12035726197063923
Epoch: 78 | Accuracy: 0.933 | Recall: 0.505 | Precision: 0.813| RMSE: 0.2585| AUC: 0.7452 | logloss_mean: 0.12018111630261523
Epoch: 79 | Accuracy: 0.933 | Recall: 0.5 | Precision: 0.819| RMSE: 0.2584| AUC: 0.7431 | logloss_mean: 0.11893777332711712
Epoch: 80 | Accuracy: 0.933 | Recall: 0.491 | Precision: 0.826| RMSE: 0.2588| AUC: 0.7392 | logloss_mean: 0.1188571687326631
Epoch: 81 | Accuracy: 0.932 | Recall: 0.473 | Precision: 0.83| RMSE: 0.2612| AUC: 0.7306 | logloss_mean: 0.11913225716160773
Epoch: 82 | Accuracy: 0.935 | Recall: 0.543 | Precision: 0.793| RMSE: 0.2558| AUC: 0.7629 | logloss_mean: 0.1187897300013133
Epoch: 83 | Accuracy: 0.934 | Recall: 0.521 | Precision: 0.803| RMSE: 0.2575| AUC: 0.7528 | logloss_mean: 0.11803730395486922
Epoch: 84 | Accuracy: 0.931 | Recall: 0.482 | Precision: 0.811| RMSE: 0.2625| AUC: 0.7342 | logloss_mean: 0.11763544806993557
Epoch: 85 | Accuracy: 0.932 | Recall: 0.501 | Precision: 0.805| RMSE: 0.2605| AUC: 0.7428 | logloss_mean: 0.11705320842961953
Epoch: 86 | Accuracy: 0.931 | Recall: 0.482 | Precision: 0.812| RMSE: 0.2624| AUC: 0.7341 | logloss_mean: 0.11641902110349496
Epoch: 87 | Accuracy: 0.933 | Recall: 0.482 | Precision: 0.833| RMSE: 0.2592| AUC: 0.7351 | logloss_mean: 0.1159718189822528
Epoch: 88 | Accuracy: 0.934 | Recall: 0.534 | Precision: 0.8| RMSE: 0.256| AUC: 0.7589 | logloss_mean: 0.11590773218483166
Epoch: 89 | Accuracy: 0.932 | Recall: 0.537 | Precision: 0.776| RMSE: 0.26| AUC: 0.7591 | logloss_mean: 0.1150287872370224
Epoch: 90 | Accuracy: 0.932 | Recall: 0.507 | Precision: 0.8| RMSE: 0.2604| AUC: 0.7456 | logloss_mean: 0.11484052696111567
Epoch: 91 | Accuracy: 0.935 | Recall: 0.521 | Precision: 0.824| RMSE: 0.2541| AUC: 0.7538 | logloss_mean: 0.11494128278103992
Epoch: 92 | Accuracy: 0.934 | Recall: 0.519 | Precision: 0.809| RMSE: 0.2568| AUC: 0.7521 | logloss_mean: 0.11443425615055902
Epoch: 93 | Accuracy: 0.933 | Recall: 0.497 | Precision: 0.82| RMSE: 0.2587| AUC: 0.742 | logloss_mean: 0.11403732108024572
Epoch: 94 | Accuracy: 0.931 | Recall: 0.482 | Precision: 0.812| RMSE: 0.2624| AUC: 0.734 | logloss_mean: 0.11359702897918167
Epoch: 95 | Accuracy: 0.932 | Recall: 0.552 | Precision: 0.763| RMSE: 0.2603| AUC: 0.7653 | logloss_mean: 0.11370279934727451
Epoch: 96 | Accuracy: 0.933 | Recall: 0.48 | Precision: 0.84| RMSE: 0.2586| AUC: 0.7344 | logloss_mean: 0.1127046667699458
Epoch: 97 | Accuracy: 0.934 | Recall: 0.497 | Precision: 0.829| RMSE: 0.2573| AUC: 0.7423 | logloss_mean: 0.11251321005029152
Epoch: 98 | Accuracy: 0.933 | Recall: 0.487 | Precision: 0.834| RMSE: 0.2583| AUC: 0.7373 | logloss_mean: 0.11310330578080803
Epoch: 99 | Accuracy: 0.935 | Recall: 0.534 | Precision: 0.81| RMSE: 0.2543| AUC: 0.7593 | logloss_mean: 0.11261151990292648
Training Finish
best model performance, AUC: 0.7749 | logloss: 0.11251321005029152

Finish
split label ==============================>
